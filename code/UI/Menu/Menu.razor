@inherits NavigatorPanel

<root class=@(IsOpen ? "open" : "closed")>
    <div class="header">
        <div class="header-logo"></div>
        <div class="header-navigation">

            <navlink href="menu/stats" class="nav-link">
                <label>Map</label>
                <div class="stroke"></div>
            </navlink>

            <navlink href="menu/achievements" class="nav-link">
                <label>Achievements</label>
                <div class="stroke"></div>
            </navlink>

            <navlink href="menu/trailpass" class="nav-link">
                <label>Trail Pass</label>
                <div class="stroke"></div>
            </navlink>

            <navlink href="menu/customize" class="nav-link">
                <label>Customize</label>
                <div class="stroke"></div>
            </navlink>

            <navlink href="menu/controls" class="nav-link">
                <label>Controls</label>
                <div class="stroke"></div>
            </navlink>
        </div>

        <div class="header-right">
            <navlink href="menu/settings" class="nav-link hidden">
                <label>Settings</label>
                <div class="stroke"></div>
            </navlink>

            <navlink class="stop-spectating" icon="cancel" onclick="StopSpectating()">
                <label>Stop Spectating</label>
                <div class="stroke"></div>
            </navlink>

            <navlink @onclick=@Close class="nav-link">
                <label>X</label>
                <div class="stroke"></div>
            </navlink>
        </div>
    </div>
    <div class="body">
        <div @ref="NavigatorCanvas" class="content"></div>
    </div>
</root>

@code {
    private bool IsOpen;

    public override void Tick()
    {
        base.Tick();

        if (Local.Pawn is not UnicyclePlayer pl) return;

        SetClass("is-spectating", pl.SpectateTarget != null);
    }

    public void Close()
    {
        IsOpen = false;
        StateHasChanged();
    }

    public void StopSpectating()
    {
        UnicyclePlayer.ServerCmd_SetSpectateTarget(-1);
        Close();
    }

    [Event.Client.BuildInput]
    private void OnBuildInput() 
    {
        if (!InputExtra.Pressed(InputActions.Menu))
            return;

        IsOpen = !IsOpen;

        if(IsOpen)
        {
            Navigate("menu/stats");
        }

        StateHasChanged();
    }
}
