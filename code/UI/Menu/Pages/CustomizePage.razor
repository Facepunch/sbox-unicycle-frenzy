@inherits Panel
@page "/customize";

<root>
	<div class="sidebar">
		<div class="navbar">
			<a class="button" href="/home">Return</a>
		</div>
	</div>
	<div class="right-side">
	</div>
	<div class="clothingpage-container">
		<div class="clothing-container">
			<CustomizePageItem SelectedCategory="@ItemCategories.Frame" Items="@Items" ></CustomizePageItem>
			<CustomizePageItem SelectedCategory="@ItemCategories.Wheel" Items="@Items" ></CustomizePageItem>
			<CustomizePageItem SelectedCategory="@ItemCategories.Pedal" Items="@Items" ></CustomizePageItem>
			<CustomizePageItem SelectedCategory="@ItemCategories.Seat" Items="@Items" ></CustomizePageItem>
		</div>
	</div>
</root>


@code {
	public static UnicycleDressed Local;
	List<UnicycleFrenzyItems> Items = new List<UnicycleFrenzyItems>();
	UnicycleProgression Progression { get; set; }
	UFItemProgression ProgressionResource { get; set; }

	public CustomizePage()
	{

	}

	protected override void OnAfterTreeRender(bool firstTime)
	{
		base.OnAfterTreeRender(firstTime);

		if (!firstTime) return;

		Fetch();

		ProgressionResource = ResourceLibrary.GetAll<UFItemProgression>().Where(x => x.IsCurrentPass).FirstOrDefault();
		Items = Progression.UnlockedItems;

	}

	void Fetch()
	{
		Progression = FileSystem.Data.ReadJson<UnicycleProgression>("unicycle.progression.json");
		if (Progression == null)
		{
			Progression = new UnicycleProgression();
		}
	}

	void Save()
	{
		if (Progression == null)
		{
			Fetch();
		}
		FileSystem.Data.WriteJson("unicycle.progression.json", Progression);
	}
}
